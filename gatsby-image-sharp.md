---
title: "【Gatsby】gatsbyImageSharpってそもそも何だよという記事"
category: "Tech"
date: "2024-03-15T22:00:00+09:00"
desc: "Gatsbyには「gatsby-image-sharp」という、画像をいい感じにしてくれるプラグインがありますが、この「sharp」って一体何でしょうか。ちょっと深堀りしてみました。"
thumbnail: ""
alt: ""
---

Gatsbyを使っていると、`gatsby-image-sharp`というプラグインに出くわします。こいつ、一体何なのでしょうか。調べてみました。

## 結論―「Sharp」というnode.js用のなんかがある

プラズマクラスターではありません。

そういうライブラリがあるらしいです。node.jsは専門外のため、AI（Bing Copilot）に質問を丸投げしました。以下が回答です。なお、読みやすさのためところどころ省略しています。

> sharpは、Node.jsで動作する高速なNode-APIモジュールで、大きな画像を小さく、ウェブフレンドリーなJPEG、PNG、WebP、GIF、AVIF画像に変換するためによく使用されます。（中略）
> sharpを使用すると、画像のリサイズ、回転、抽出、合成、ガンマ補正などの操作が可能で、libvipsを使用することでImageMagickやGraphicsMagickの設定よりも4〜5倍高速に画像をリサイズできます。色空間、埋め込まれたICCプロファイル、アルファ透明チャネルも正しく処理されます。Lanczosリサンプリングにより、速度を犠牲にすることなく品質が保たれます。

ということで、Gatsbyなどを使うだけであれば、**画像変形や軽量化をしてくれる、node.jsのすげーやつ**ぐらいの理解で十分だと思います。

## なぜ調べるに至ったか？

私のブログのトップページには記事一覧があるのですが、そのサムネの切り取り方が気持ち悪くなった時期がありました。



これは何が原因なのかと思っていましたが、どうやらGraphQLから画像を受け取るときにsharpの加工を介在するらしく、この切り抜き方法が曲者だった事がわかりました。



調整してみたところ、謎に偏っていたサムネの位置（これまでは何かの比重？を見て中心位置を決めていたようでした）がちゃんと真ん中に来るようになりました。普通の写真などであればいいかもしれませんが、「せっかくサムネに文字を入れたのに見切れた！」なんていうのは最悪ですからね。

Sharp、地味な存在ではありますが、Gatsbyを使うなら気にかけてあげるといいかもしれません。
